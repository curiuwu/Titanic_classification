# Проект по предсказанию выживания на Титанике

## Обзор

Этот проект анализирует знаменитый датасет Титаника для предсказания выживания пассажиров с использованием методов машинного обучения. Датасет включает признаки, такие как класс пассажира, возраст, пол, стоимость билета и порт посадки. Мы проводим EDA для понимания данных, обрабатываем пропущенные значения и выбросы, а затем обучаем несколько моделей классификации: логистическую регрессию, случайный лес и градиентный бустинг. Лучшая модель (случайный лес) оценивается с использованием метрик ROC-AUC и F1-score и сохраняется для дальнейшего использования.

Проект демонстрирует предобработку данных, выбор модели с настройкой гиперпараметров через RandomizedSearchCV, кросс-валидацию и сравнение моделей.

### Ключевые шаги в ноутбуке:
1. **Загрузка данных и EDA**: Загрузка `train.csv`, проверка формы, информации, описания и пропущенных значений.
2. **Предобработка**: Обработка пропущенных значений (заполнение медианой для Age и Fare, удаление Cabin), кодирование категориальных признаков (Sex, Embarked), удаление выбросов с помощью метода IQR.
3. **Обучение моделей**:
   - Логистическая регрессия
   - Случайный лес (с настройкой гиперпараметров)
   - Градиентный бустинг (с настройкой гиперпараметров)
4. **Оценка**: Использование ROC-AUC, F1-score и отчёта классификации на тестовых данных. Кросс-валидация для оценки стабильности.
5. **Результаты**: Случайный лес достигает наивысшего ROC-AUC (~0.86) и F1-score (~0.74).
6. **Сохранение модели**: Лучшая модель случайного леса сохраняется как `models/random_forest.joblib`.

Ноутбук раскрывает insights, такие как более высокие шансы на выживание у женщин и пассажиров первого класса.

## Датасет
- **Источник**: Датасет Титаника с Kaggle (train.csv с 891 строками, 12 столбцами).
- **Цель**: `Survived` (0 = Нет, 1 = Да).
- **Признаки**: PassengerId, Pclass, Name, Sex, Age, SibSp, Parch, Ticket, Fare, Cabin, Embarked.

## Требования
Установите зависимости из `requirements.txt`:

```bash
pip install -r requirements.txt
```

Ключевые библиотеки:
- pandas, numpy
- matplotlib, seaborn
- scikit-learn (для моделей, предобработки и оценки)
- joblib (для сохранения модели)

## Использование
1. Клонируйте репозиторий:
   ```
   git clone <your-repo-url>
   cd <project-name>
   ```
2. Убедитесь, что `train.csv` находится в корневой директории (скачайте с Kaggle, если нужно).
3. Откройте и запустите `classification_with_EDA.ipynb` в Jupyter Notebook или JupyterLab:
   ```
   jupyter notebook classification_with_EDA.ipynb
   ```
4. Ноутбук выполнит:
   - EDA и предобработку.
   - Обучение и оценку моделей.
   - Вывод таблиц результатов и графиков (например, гистограммы, тепловые карты корреляций).
   - Сохранение лучшей модели в `models/random_forest.joblib`.

Для загрузки и использования сохранённой модели:
```python
from joblib import load
import pandas as pd

model = load('models/random_forest.joblib')
# Пример предсказания (предполагая предобработанные данные)
new_data = pd.DataFrame(...)  # Ваши новые данные пассажира
prediction = model.predict(new_data)
probabilities = model.predict_proba(new_data)
```

## Сводка результатов
Сравнение моделей на тестовом наборе:

| Модели       | ROC-AUC  | F1-Score |
|--------------|----------|----------|
| Log-reg     | 0.8614  | 0.7407  |
| RandomForest| 0.8327  | 0.6452  |
| GB          | 0.8262  | 0.6772  |

- **Лучшая модель**: Случайный лес (после настройки: n_estimators=200, max_depth=5 и т.д.).
- ROC-AUC кросс-валидации: 0.8653 ± 0.0259 (указывает на хорошую обобщаемость, хотя отмечено некоторое переобучение).

Возможные улучшения: Инженерия признаков (например, извлечение титулов из Name), ансамблевые методы или более агрессивная обработка дисбаланса классов.

## Структура
- `.gitignore`: Игнорирует временные файлы (например, __pycache__, .ipynb_checkpoints).
- `classification_with_EDA.ipynb`: Основной Jupyter-ноутбук.
- `LICENSE`: Лицензия проекта (например, MIT).
- `README.md`: Этот файл.
- `requirements.txt`: Зависимости.
- `train.csv`: Данные для обучения Титаника.
- `models/`: Директория для сохранённых моделей (создаётся во время выполнения).

## Вклад
Не стесняйтесь форкать репозиторий, открывать issues или отправлять pull request'ы для улучшений, таких как добавление дополнительных моделей (например, XGBoost) или деплой модели (например, через Streamlit).

## Лицензия
Этот проект лицензирован под MIT License — см. файл [LICENSE](LICENSE) для деталей.

## Благодарности
- Датасет: [Titanic - Machine Learning from Disaster (Kaggle)](https://www.kaggle.com/c/titanic).
- Создано с использованием Python, scikit-learn и Jupyter.